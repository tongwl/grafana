<page-header model="ctrl.navModel"></page-header>

<div class="page-container page-body">
  <h3 class="page-sub-heading">用户信息</h3>

  <form name="ctrl.userForm" class="gf-form-group">

    <div class="gf-form max-width-30">
      <span class="gf-form-label width-8">姓名</span>
      <input class="gf-form-input max-width-22" type="text" required ng-model="ctrl.user.name">
    </div>
    <div class="gf-form max-width-30">
      <span class="gf-form-label width-8">邮箱</span>
      <input class="gf-form-input max-width-22" type="email" ng-readonly="ctrl.readonlyLoginFields" required ng-model="ctrl.user.email">
      <i ng-if="ctrl.readonlyLoginFields" class="fa fa-lock gf-form-icon--right-absolute" bs-tooltip="'邮箱已上锁'"></i>
    </div>
    <div class="gf-form max-width-30">
      <span class="gf-form-label width-8">登录名</span>
      <input class="gf-form-input max-width-22" type="text" ng-readonly="ctrl.readonlyLoginFields" required ng-model="ctrl.user.login">
      <i ng-if="ctrl.readonlyLoginFields" class="fa fa-lock gf-form-icon--right-absolute" bs-tooltip="'登录名已上锁'"></i>
    </div>
    <div class="gf-form-button-row">
      <button type="submit" class="btn btn-primary" ng-click="ctrl.update()">保存</button>
    </div>
  </form>

  <prefs-control resource-uri="'user'"></prefs-control>

  <h3 class="page-heading" ng-show="ctrl.showTeamsList">团队</h3>
  <div class="gf-form-group" ng-show="ctrl.showTeamsList">
    <table class="filter-table form-inline">
      <thead>
        <tr>
          <th></th>
          <th>姓名</th>
          <th>邮箱</th>
          <th>成员</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="team in ctrl.teams">
          <td class="width-4 text-center"><img class="filter-table__avatar" src={{team.avatarUrl}}></td>
          <td>{{team.name}}</td>
          <td>{{team.email}}</td>
          <td>{{team.memberCount}}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <h3 class="page-heading" ng-show="ctrl.showOrgsList">组织</h3>
  <div class="gf-form-group" ng-show="ctrl.showOrgsList">
    <table class="filter-table form-inline">
      <thead>
        <tr>
          <th>姓名</th>
          <th>角色</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="org in ctrl.orgs">
          <td>{{org.name}}</td>
          <td>{{org.role}}</td>
          <td class="text-right">
            <span class="btn btn-primary btn-small" ng-show="org.orgId === contextSrv.user.orgId">
              所属组织
            </span>
            <a ng-click="ctrl.setUsingOrg(org)" class="btn btn-inverse btn-small" ng-show="org.orgId !== contextSrv.user.orgId">
              加入
            </a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
